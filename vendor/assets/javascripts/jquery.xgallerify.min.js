!function(e){function i(i,o){o.jsSetup&&t(i,o.margin),i.addClass("xgallerify"),m?n(i,o):e(window).on("load",function(){n(i,o)}),e(window).resize(function(){n(i,o)})}function t(i,t){jChildren=e(i.children()),jChildren.css("display","inline-block").css("margin",t).find("img").css("width","100%").addClass("ximage-loaded")}function n(i,t){var n=[],a=[],d=i.children(),s=t.width||i.width(),m=h(s,t.mode);imagesPerRow=t.imagesPerRow||m.itemsPerRow;var u;t.width&&i.width(s);for(var g=0;g<d.length;g++){var w=e(d[g]);w.width()&&(n.push(w),(n.length>=imagesPerRow||g==d.length-1)&&(a.push(n),g==d.length-1&&n.length<m.itemsPerRow&&"fullwidth"!=t.lastRow?r(a[a.length-1],s,t.margin,u):u=o(a[a.length-1],s,t.margin,m.maxHeight),u<m.maxHeight&&(n=[])))}}function o(e,i,t,n){return a(e,n),d(e,i,t)}function r(i,t,n,o){o=a(i,o);var r=0;return e(i).each(function(){r+=e(this).width()}),r>t&&(o=d(i,t,n)),o}function a(e,i){for(var t=0;t<e.length;t++){var n=i/e[t].height();e[t].width();e[t].width(e[t].width()*n)}return e[0].height()}function d(i,t,n){var o=0;e(i).each(function(){o+=e(this).width()});for(var r=(t-i.length*(n+4)*2)/o,a=0;a<i.length;a++)i[a].css("width",i[a].width()*r);return i[0].height()}function h(e,i){var t={itemsPerRow:void 0,maxHeight:void 0};return 768>=e&&(t.maxHeight=screen.height),"bootstrap"==i?(e>1200?t.itemsPerRow=4:e>992?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=.4,e>768&&(t.maxHeight=.5*screen.height)):"flickr"==i?(e>1800?t.itemsPerRow=4:e>1300?t.itemsPerRow=3:e>610?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.4*screen.height)):"small"==i?(e>1800?t.itemsPerRow=14:e>1300?t.itemsPerRow=10:e>610?t.itemsPerRow=6:t.itemsPerRow=4,e>768&&(t.maxHeight=.4*screen.height)):(e>1800?t.itemsPerRow=4:e>1200?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.5*screen.height)),t}function s(e,i,t){var n;return function(){var o=this,r=arguments,a=function(){n=null,t||e.apply(o,r)},d=t&&!n;clearTimeout(n),n=setTimeout(a,i),d&&e.apply(o,r)}}var m=!1;e(window).load(function(){m=!0}),e.fn.gallerify=function(e){var o=this;e=e||{},e.margin=void 0!=e.margin&&null!=e.margin?e.margin:10,e.width=e.width||void 0,e.mode=e.mode||"default",e.jsSetup=void 0!=e.jsSetup?e.jsSetup:!0,e.imagesPerRow=e.imagesPerRow||void 0,e.debounceLoad=void 0!=e.debounceLoad?e.debounceLoad:!0,e.debounceTime=void 0!=e.debounceTime?e.debounceTime:50,e.lastRow=e.lastRow||"adjust",i(o,e),this.gallerify.render=function(){t(o,e.margin),n(o,e)};var r=s(function(){n(o,e)},e.debounceTime);return this.gallerify.renderAsyncImages=function(){t(o,e.margin),e.debounceLoad?o.find("img").load(function(){r()}):o.find("img").load(function(){n(o,e)})},o}}(jQuery);